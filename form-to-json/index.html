<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>فرم به جیسون</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f9fafb;
      margin: 0;
      padding: 20px;
      display: flex;
      justify-content: center;
    }
    .container {
      max-width: 800px;
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      width: 100%;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    .title-box {
      width: 50%;
      grid-column: span 2;
      background: white; /* سفید بمونه */
      color: #8b5cf6;    /* متن بنفش */
      padding: 12px;
      border-radius: 12px;
      text-align: center;
      font-weight: bold;
      font-size: 1.2em;
      border-bottom: 1px solid #8b5cf6;
      margin: 0 auto;
      margin-bottom: 30px;
    }

    h1, h2 { 
      margin-top: 0; 
      text-align: center;
    }
    .field {
      border: 1px solid #ddd;
      padding: 10px;
      border-radius: 8px;
      margin-bottom: 10px;
      display: grid;
      grid-template-columns: 1fr 1fr auto;
      gap: 10px;
      align-items: end;
    }
    input {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    button {
      cursor: pointer;
      padding: 8px 12px;
      border-radius: 6px;
      border: 1px solid #ccc;
      background: #f3f4f6;
    }
    button:hover { background: #e5e7eb; }
    .primary { background: #4f46e5; color: white; border: none; }
    .primary:hover { background: #4338ca; }
    pre {
      background: #f3f4f6;
      padding: 10px;
      border-radius: 8px;
      overflow-x: auto;
      white-space: pre-wrap;
    }
    .json-panel {
      display: flex;
      flex-direction: column;
      gap: 10px;
      direction: ltr;
    }
    .copied {
      color: green;
      font-size: 0.9em;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- عنوان بالای فرم -->
    <div class="title-box">اتوموبی اتومیشن</div>

    <!-- فرم -->
    <div>
      <h1>فرم ورودی</h1>
      <div id="fields"></div>
      <div style="margin-top:10px; display:flex; gap:10px;">
        <button onclick="addField()">➕ افزودن فیلد</button>
        <button onclick="resetFields()">🔄 بازنشانی</button>
      </div>
      <div style="margin-top:10px; display:flex; gap:10px; align-items:center;">
        <button class="primary" onclick="buildAndCopyJson()">🛠️📋 ساخت و کپی JSON</button>
        <button onclick="clearOutput()">🗑️ پاک کردن خروجی</button>
        <span style="margin-right:auto; font-size:0.9em; color:gray;">فیلدها: <span id="count">0</span></span>
      </div>
    </div>

    <!-- خروجی -->
    <div class="json-panel">
      <h2>خروجی JSON</h2>
      <pre id="output" dir="ltr">{}</pre>
      <div id="copiedMsg" class="copied" style="display:none;">✔ کپی شد</div>
    </div>
  </div>

  <script>
    let fields = [];
    let outputJson = null;

    function renderFields() {
      const container = document.getElementById("fields");
      container.innerHTML = "";
      fields.forEach((f, idx) => {
        const div = document.createElement("div");
        div.className = "field";
        div.innerHTML = `
          <div>
            <label style="font-size:0.8em;color:gray;">عنوان</label>
            <input value="${f.title}" oninput="updateField(${f.id}, 'title', this.value)" placeholder="عنوان ${idx+1}" />
          </div>
          <div>
            <label style="font-size:0.8em;color:gray;">مقدار</label>
            <input value="${f.value}" oninput="updateField(${f.id}, 'value', this.value)" placeholder="مقدار ${idx+1}" />
          </div>
          <div style="display:flex; gap:5px;">
            <button onclick="removeField(${f.id})">🗑</button>
            <button onclick="duplicateField(${f.id})">📑</button>
          </div>
        `;
        container.appendChild(div);
      });
      document.getElementById("count").innerText = fields.length;
    }

    function addField() {
      fields.push({id: Date.now()+Math.random(), title:"", value:""});
      renderFields();
    }

    function removeField(id) {
      if(fields.length === 1) return;
      fields = fields.filter(f => f.id !== id);
      renderFields();
    }

    function duplicateField(id) {
      const f = fields.find(x => x.id === id);
      const idx = fields.indexOf(f);
      const copy = {id: Date.now()+Math.random(), title: f.title, value: f.value};
      fields.splice(idx+1, 0, copy);
      renderFields();
    }

    function updateField(id, key, val) {
      fields = fields.map(f => f.id === id ? {...f, [key]: val} : f);
    }

    function resetFields() {
      fields = [{id: Date.now(), title:"", value:""}];
      renderFields();
    }

    function buildAndCopyJson() {
      const obj = {};
      fields.forEach(f => {
        if(f.title.trim()) {
          obj[f.title.trim()] = f.value.trim();
        }
      });
      outputJson = obj;
      const jsonText = JSON.stringify(outputJson, null, 2);
      document.getElementById("output").innerText = jsonText;
      
      navigator.clipboard.writeText(jsonText).then(() => {
        const msg = document.getElementById("copiedMsg");
        msg.style.display = "block";
        setTimeout(() => msg.style.display = "none", 2000);
      });
    }

    function clearOutput() {
      outputJson = null;
      document.getElementById("output").innerText = "{}";
    }

    resetFields();
  </script>
</body>
</html>
